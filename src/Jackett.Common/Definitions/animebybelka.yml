---
id: animebybelka
name: Anime by Belka
description: "Anime by Belka (Аниме от Белки) is a RUSSIAN Semi-Private Torrent Tracker for ANIME"
language: ru-RU
type: semi-private
encoding: UTF-8
links:
  - https://anibelka.com/

caps:
  categorymappings:
#    - {id: 1, cat: TV/Anime, desc: "Трекер"}
#    - {id: 31, cat: TV/Anime, desc: "Аниме архив"}
    - {id: 32, cat: TV/Anime, desc: "Аниме универсальные"}
    - {id: 33, cat: TV/Anime, desc: "Аниме с озвучкой"}
    - {id: 34, cat: TV/Anime, desc: "Аниме с субтитрами"}
    - {id: 36, cat: Movies/Other, desc: "Полнометражки"}
    - {id: 37, cat: TV/Anime, desc: "Аниме для PSP"}
    - {id: 39, cat: TV/Anime, desc: "Сэмплы"}
    - {id: 7, cat: Audio, desc: "Аудио"}
    - {id: 8, cat: Books/Comics, desc: "Манга"}
    - {id: 21, cat: Other, desc: "Изображения аниме"}
    - {id: 9, cat: Other, desc: "Япония"}
#    - {id: 17, cat: Other, desc: "Информация"}
#    - {id: 40, cat: Other, desc: "Аниме онлайн"}
#    - {id: 41, cat: Other, desc: "Галерея Японии"}
#    - {id: 42, cat: Other, desc: "Фанфики по аниме"}
#    - {id: 43, cat: Other, desc: "Отзывы, просьбы, предложения, техника"}
    - {id: 52, cat: TV/Anime, desc: "Альтернативные части"}
#    - {id: 49, cat: Other, desc: "Форум"}
#    - {id: 50, cat: Other, desc: "Аниме. Форум. Обсуждение"}

  modes:
    search: [q]
    tv-search: [q, season, ep]
    movie-search: [q]
    music-search: [q]
    book-search: [q]

settings:
  - name: username
    type: text
    label: Username
  - name: password
    type: password
    label: Password
  - name: stripcyrillic
    type: checkbox
    label: Strip Cyrillic Letters
    default: false
  - name: addrussiantotitle
    type: checkbox
    label: Add RUS to end of all titles to improve language detection by Sonarr and Radarr. Will cause English-only results to be misidentified.
    default: false
  - name: sort
    type: select
    label: Sort requested from site
    default: t
    options:
      t: created
      ts: seeders
      sz: size
      i: title
  - name: type
    type: select
    label: Order requested from site
    default: d
    options:
      d: desc
      a: asc

login:
  path: ucp.php?mode=login
  method: form
  form: form[action^="./ucp.php?mode=login"]
  inputs:
    username: "{{ .Config.username }}"
    password: "{{ .Config.password }}"
    autologin: on
    redirect: index.php
    login: Войти
  selectorinputs:
    sid:
      selector: input[name="sid"]
      attribute: value
  error:
    - selector: span.error
  test:
    path: /
    selector: a[href^="./ucp.php?mode=logout&sid="]

search:
  paths:
    # https://anibelka.com/search.php?tracker_search=torrent&keywords=nyan&terms=all&author=&fid%5B%5D=31&sc=1&sf=titleonly&sk=t&sd=d&sr=topics&st=0&ch=300&t=0
    - path: search.php
  inputs:
    $raw: "{{ range .Categories }}&fid[]={{.}}{{end}}"
    tracker_search: "{{ if .Keywords }}torrent{{ else }}tracker{{ end }}"
    keywords: "{{ if .Keywords }}{{ .Keywords }}{{ else }}{{ .Today.Year }}{{ end }}"
    terms: all
    sc: 1
    sf: titleonly
    sr: topics
    sk: "{{ .Config.sort }}"
    sd: "{{ .Config.type }}"
    st: 0
    ch: 300
    t: 0

  keywordsfilters:
    # strip season and/or ep
    - name: re_replace
      args: ["(?i)\\b(?:[SE]\\d{1,4}){1,2}\\b\\s?", ""]

  rows:
    selector: tr:has(a[href^="./download/file.php?id="])

  fields:
    category:
      selector: a[href^="./viewforum.php?f="]
      attribute: href
      filters:
        - name: querystring
          args: f
    title:
      selector: a.topictitle
      filters:
        - name: re_replace
          args: ["(\\([\\p{IsCyrillic}\\W]+\\))|(^[\\p{IsCyrillic}\\W\\d]+\\/ )|([\\p{IsCyrillic} \\-]+,+)|([\\p{IsCyrillic}]+)", "{{ if .Config.stripcyrillic }}{{ else }}$1$2$3$4{{ end }}"]
        - name: append
          args: "{{ if .Config.addrussiantotitle }} RUS{{ else }}{{ end }}"
    details:
      selector: a.topictitle
      attribute: href
    download:
      selector: a[href^="./download/file.php?id="]
      attribute: href
    size:
      selector: p b
      filters:
        - name: replace
          args: ["ТБ", "TB"]
        - name: replace
          args: ["ГБ", "GB"]
        - name: replace
          args: ["МБ", "MB"]
        - name: replace
          args: ["КБ", "KB"]
    seeders:
      selector: span.seed
    leechers:
      selector: span.leech
    grabs:
      selector: span.complet
      optional: true
    date_today:
      # Сегодня, 09:09
      # Вчера, 22:47
      selector: td:nth-last-child(1) p:contains("Сегодня"), td:nth-last-child(1) p:contains("Вчера")
      optional: true
      filters:
        - name: replace
          args: ["Сегодня", "Today"]
        - name: replace
          args: ["Вчера", "Yesterday"]
        - name: fuzzytime
    date_year:
      # 12 янв 2019, 11:26
      selector: td:nth-last-child(1) p:not(:contains("Сегодня")), td:nth-last-child(1) p:not(:contains("Вчера"))
      # auto adjusted by site account profile
      optional: true
      filters:
        - name: replace
          args: ["янв", "Jan"]
        - name: replace
          args: ["фев", "Feb"]
        - name: replace
          args: ["мар", "Mar"]
        - name: replace
          args: ["апр", "Apr"]
        - name: replace
          args: ["май", "May"]
        - name: replace
          args: ["июн", "Jun"]
        - name: replace
          args: ["июл", "Jul"]
        - name: replace
          args: ["авг", "Aug"]
        - name: replace
          args: ["сен", "Sep"]
        - name: replace
          args: ["окт", "Oct"]
        - name: replace
          args: ["ноя", "Nov"]
        - name: replace
          args: ["дек", "Dec"]
        - name: append
          args: " +03:00" # MSK
        - name: dateparse
          args: "dd MMM yyyy, HH:mm zzz"
    date:
      text: "{{ if or .Result.date_today .Result.date_year }}{{ or .Result.date_today .Result.date_year }}{{ else }}now{{ end }}"
    downloadvolumefactor:
      text: 0
    uploadvolumefactor:
      text: 1
    description:
      selector: td:nth-last-child(5)
      remove: a, b, p, span
# ppkBB3cker v.2 (phpBB)
